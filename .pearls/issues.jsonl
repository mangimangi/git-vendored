{"id":"gv-d942","title":"Refactor install into add + update","status":"open","issue_type":"epic","priority":2,"created_at":"2026-02-10T04:38:09Z"}
{"id":"gv-d942.1","title":"Rename vendored/install to vendored/update","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-10T04:48:39Z","parent":"gv-d942","body":"Rename the install script to update, reflecting that it only operates on already-registered vendors.\n\n## Scope\n\n- Rename `vendored/install` \u2192 `vendored/update`\n- Rename `tests/test_install.py` \u2192 `tests/test_update.py`\n- Update internal references in the test file (dynamic import path, module name)\n- Improve unknown-vendor error to list registered vendors:\n  ```\n  ::error::Unknown vendor: typo-name\n  Registered vendors: git-vendored, git-semver, git-dogfood, pearls\n  ```\n\n## Acceptance Criteria\n\n- [ ] `vendored/install` no longer exists; `vendored/update` exists with identical logic\n- [ ] `tests/test_install.py` no longer exists; `tests/test_update.py` exists\n- [ ] All tests pass after the rename (dynamic import path and any internal references updated)\n- [ ] Unknown vendor error message includes a list of registered vendor names from config\n- [ ] No other files reference the old `vendored/install` path (except install.sh and workflow template \u2014 those are handled in later issues)","deps":[{"id":"gv-d942.2","type":"blocks"},{"id":"gv-d942.5","type":"blocks"}],"started_at":"2026-02-10T05:01:46Z","commit":"566dd60","implementer":"claude-opus-4-6","cost":{"input":35000,"output":8000},"implemented_at":"2026-02-10T05:03:36Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:21:04Z","scores":{"correctness":95,"completeness":95,"quality":90,"testing":88,"documentation":85},"score":90.6},"closed_at":"2026-02-10T05:21:54Z"}
{"id":"gv-d942.2","title":"Write GITHUB_OUTPUT directly from Python in vendored/update","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-10T04:48:56Z","parent":"gv-d942","body":"Have vendored/update write workflow outputs directly to $GITHUB_OUTPUT instead of relying on fragile grep/cut/python stdout parsing in the workflow shell step.\n\n## Scope\n\n**Edit `vendored/update`:**\n- When `$GITHUB_OUTPUT` env var is set, write key=value pairs to that file:\n  - Single-vendor mode: `vendor`, `old_version`, `new_version`, `changed`, `install_branch`\n  - All-vendors mode: `changed_vendors` (JSON), `changed_count`\n- Continue printing human-readable stdout output (useful for local runs and logs)\n\n**Edit `templates/github/workflows/install-vendored.yml`:**\n- Remove the grep/cut/python one-liner parsing of stdout\n- Reference step outputs directly (e.g., `steps.update.outputs.changed`)\n\n**Edit `tests/test_update.py`:**\n- Add tests that verify GITHUB_OUTPUT file is written correctly when the env var is set\n- Add tests that verify no GITHUB_OUTPUT file is written when the env var is not set\n- Existing stdout-based tests should still pass (human-readable output preserved)\n\n## Acceptance Criteria\n\n- [ ] `vendored/update` writes key=value pairs to `$GITHUB_OUTPUT` file when env var is set\n- [ ] Stdout output is preserved for human readability\n- [ ] Workflow template no longer parses stdout \u2014 uses step outputs directly\n- [ ] `tests/test_update.py` includes tests for GITHUB_OUTPUT writing (set and unset)\n- [ ] All existing tests pass","deps":[{"id":"gv-d942.1","type":"blocked_by"},{"id":"gv-d942.3","type":"precedes"}],"started_at":"2026-02-10T05:05:50Z","commit":"1894c6a","implementer":"claude-opus-4-6","cost":{"input":40000,"output":12000},"implemented_at":"2026-02-10T05:07:15Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:21:07Z","scores":{"correctness":90,"completeness":90,"quality":85,"testing":90,"documentation":80},"score":87.0},"closed_at":"2026-02-10T05:21:58Z"}
{"id":"gv-d942.3","title":"Fix workflow token leaking and automerge default","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-10T04:49:13Z","parent":"gv-d942","body":"Fix two issues in the workflow template: VENDOR_PAT leaking into PR creation, and automerge defaulting to true.\n\n## Scope\n\n**Token fix in `templates/github/workflows/install-vendored.yml`:**\n- Update step uses VENDOR_PAT (for private repo downloads): `GH_TOKEN: ${{ secrets.token || secrets.VENDOR_PAT || github.token }}`\n- PR creation step always uses github.token: `GH_TOKEN: ${{ github.token }}`\n- This prevents a PAT scoped for private repo reads from being used for PR operations on public vendors\n\n**Automerge default fix:**\n- Default automerge to `false` in the workflow\n- Only automerge when the vendor's config explicitly has `\"automerge\": true`\n- Document the default in the config shape\n\n**PR creation improvements:**\n- Add `--head \"$BRANCH\"` to `gh pr create` command\n- Handle \"PR already exists\" case gracefully (don't fail the workflow)\n\n## Acceptance Criteria\n\n- [ ] PR creation step uses `${{ github.token }}`, not VENDOR_PAT\n- [ ] Update/download step retains VENDOR_PAT for private repo access\n- [ ] Automerge defaults to `false` \u2014 only enabled when vendor config has `\"automerge\": true`\n- [ ] `gh pr create` includes `--head` flag with the branch name\n- [ ] Workflow does not fail if a PR already exists for the branch\n- [ ] All existing tests pass","deps":[{"id":"gv-d942.2","type":"follows"},{"id":"gv-d942.8","type":"causes"}],"started_at":"2026-02-10T05:07:29Z","commit":"fca823f","implementer":"claude-opus-4-6","cost":{"input":25000,"output":5000},"implemented_at":"2026-02-10T05:08:14Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:21:11Z","scores":{"correctness":92,"completeness":85,"quality":88,"testing":55,"documentation":78},"score":79.6},"closed_at":"2026-02-10T05:32:52Z"}
{"id":"gv-d942.4","title":"Create vendored/add command","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-10T04:49:44Z","parent":"gv-d942","body":"New command for first-time vendor registration. Run locally by the user (not by workflows).\n\n## Scope\n\n**New file: `vendored/add`**\n\nUsage: `python3 .vendored/add <owner/repo> [--name <name>]`\n\nFlow:\n1. **Pre-validate** the target repo:\n   - Confirm `install.sh` exists at repo root (via `gh api repos/{owner/repo}/contents/install.sh`)\n   - Confirm version is resolvable (GitHub Releases API or VERSION file fallback)\n   - Fail with \"repo does not implement git-vendored\" if either is missing\n2. **Snapshot** `.vendored/config.json` (before state)\n3. **Run** the vendor's `install.sh` (download and execute with resolved version)\n4. **Post-validate** the config entry the vendor registered:\n   - Diff config before/after to find the new entry\n   - Required fields: `repo`, `protected`, `install_branch`\n   - Fail if `install.sh` didn't register itself\n5. **Output** summary of what was added (vendor name, version, registered files)\n\nError cases:\n- Repo doesn't exist or is inaccessible \u2192 error with auth hint\n- No `install.sh` found \u2192 \"repo does not implement git-vendored\"\n- `install.sh` didn't write a config entry \u2192 \"install.sh must self-register\"\n- Vendor already registered \u2192 error suggesting to use update instead\n\n**New file: `tests/test_add.py`**\n\nFollow existing test patterns: dynamic module import, `tmp_repo` + `make_config` fixtures, `monkeypatch` for env vars, `unittest.mock.patch` for subprocess calls.\n\n### Test Plan\n\n**TestPreValidate:**\n- `test_repo_with_install_sh_passes` \u2014 Mock GitHub API returns install.sh \u2192 no error\n- `test_repo_without_install_sh_fails` \u2014 Mock API returns 404 \u2192 exits with \"does not implement git-vendored\"\n- `test_repo_not_found_fails` \u2014 Mock API returns 404 for repo \u2192 exits with auth hint\n- `test_version_resolvable_from_releases` \u2014 Mock releases API returns tag \u2192 version resolved\n- `test_version_resolvable_from_version_file` \u2014 Mock releases fails, VERSION file fallback works\n- `test_version_not_resolvable_fails` \u2014 Both methods fail \u2192 exits with error\n\n**TestSnapshotAndDiff:**\n- `test_detects_new_config_entry` \u2014 Config before has 1 vendor, after has 2 \u2192 new entry found\n- `test_no_new_entry_fails` \u2014 Config unchanged after install.sh \u2192 exits with \"must self-register\"\n\n**TestPostValidate:**\n- `test_valid_entry_passes` \u2014 New entry has repo, protected, install_branch \u2192 success\n- `test_missing_repo_fails` \u2014 Missing repo \u2192 exits with clear message\n- `test_missing_protected_fails` \u2014 Missing protected \u2192 exits with clear message\n- `test_missing_install_branch_fails` \u2014 Missing install_branch \u2192 exits with clear message\n\n**TestAddVendor (integration):**\n- `test_add_new_vendor` \u2014 Full flow: pre-validate \u2192 run install.sh \u2192 post-validate \u2192 success output\n- `test_add_already_registered_fails` \u2014 Vendor already in config \u2192 exits with \"already registered\"\n- `test_add_with_custom_name` \u2014 `--name` flag overrides vendor key in config lookup\n\n**TestAddOutput:**\n- `test_summary_shows_vendor_name` \u2014 Output includes vendor name\n- `test_summary_shows_version` \u2014 Output includes installed version\n- `test_summary_shows_registered_files` \u2014 Output includes what install.sh added to config\n\n## Acceptance Criteria\n\n- [ ] `vendored/add` exists and is executable\n- [ ] Pre-validates target repo has `install.sh` and resolvable version\n- [ ] Snapshots config, runs vendor's install.sh, then post-validates the new config entry\n- [ ] Post-validation checks for required fields: `repo`, `protected`, `install_branch`\n- [ ] Clear error messages for all failure cases (no install.sh, no version, no self-registration, already registered)\n- [ ] `--name` flag allows overriding the vendor key\n- [ ] `tests/test_add.py` exists with all test cases from the test plan above\n- [ ] All tests pass","deps":[{"id":"gv-d942.5","type":"blocks"}],"started_at":"2026-02-10T05:03:48Z","commit":"191a4a1","implementer":"claude-opus-4-6","cost":{"input":45000,"output":15000},"implemented_at":"2026-02-10T05:05:38Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:21:14Z","scores":{"correctness":90,"completeness":92,"quality":88,"testing":92,"documentation":85},"score":89.4},"closed_at":"2026-02-10T05:22:01Z"}
{"id":"gv-d942.5","title":"Update install.sh bootstrap for add/update rename and migration","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-10T04:50:03Z","parent":"gv-d942","body":"Update the bootstrap install.sh to download the new files, clean up the old install script, and patch existing workflow files.\n\n## Scope\n\n**Edit `install.sh`:**\n\nDownload changes:\n- Download `vendored/add` \u2192 `.vendored/add` (new)\n- Download `vendored/update` \u2192 `.vendored/update` (renamed from install)\n- Download `vendored/check` \u2192 `.vendored/check` (unchanged)\n\nMigration cleanup:\n- `rm -f .vendored/install` \u2014 remove the old script from repos that had it installed\n\nWorkflow patching:\n- After downloading files, patch existing workflow files that reference the old path\n- In `.github/workflows/install-vendored.yml`, replace `python3 .vendored/install` with `python3 .vendored/update`:\n  ```bash\n  if [ -f .github/workflows/install-vendored.yml ]; then\n      sed -i 's|python3 \\.vendored/install|python3 .vendored/update|g' \\\n          .github/workflows/install-vendored.yml\n  fi\n  ```\n\nUnchanged:\n- Self-registration logic stays\n- First-install-only guard for workflow templates stays\n\n**Edit `tests/test_installer.py`:**\n- Update tests to verify `.vendored/add` is downloaded and executable\n- Update tests to verify `.vendored/update` is downloaded (not `.vendored/install`)\n- Add test verifying `rm -f .vendored/install` cleanup occurs\n- Add test verifying workflow patching (sed replacement) works\n\n## Acceptance Criteria\n\n- [ ] `install.sh` downloads `vendored/add` \u2192 `.vendored/add`\n- [ ] `install.sh` downloads `vendored/update` \u2192 `.vendored/update`\n- [ ] `install.sh` runs `rm -f .vendored/install` to clean up old script\n- [ ] `install.sh` patches `.github/workflows/install-vendored.yml` to replace old path references\n- [ ] `.vendored/add` and `.vendored/update` are executable after install\n- [ ] `tests/test_installer.py` updated with tests for new download targets, cleanup, and patching\n- [ ] All tests pass","deps":[{"id":"gv-d942.1","type":"blocked_by"},{"id":"gv-d942.4","type":"blocked_by"},{"id":"gv-d942.6","type":"precedes"},{"id":"gv-d942.7","type":"causes"}],"started_at":"2026-02-10T05:08:26Z","commit":"140a2f3","implementer":"claude-opus-4-6","cost":{"input":30000,"output":10000},"implemented_at":"2026-02-10T05:09:53Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:21:18Z","scores":{"correctness":90,"completeness":85,"quality":85,"testing":88,"documentation":82},"score":86.0},"closed_at":"2026-02-10T05:22:06Z"}
{"id":"gv-d942.6","title":"Create project README","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-10T04:50:23Z","parent":"gv-d942","body":"Create a comprehensive but simple README.md for the git-vendored project.\n\n## Scope\n\n**New file: `README.md`**\n\nThe README should cover:\n\n1. **What git-vendored is** \u2014 one-paragraph summary: automated vendor install control for repo-embedded tools via GitHub workflows\n2. **How it works** \u2014 brief explanation of the vendor contract (install.sh + config self-registration + version discovery)\n3. **Quick start** \u2014 how to bootstrap git-vendored in a new repo (run install.sh)\n4. **Adding a vendor** \u2014 usage of `vendored/add` command\n5. **How updates work** \u2014 the automated workflow: schedule/manual trigger \u2192 vendored/update \u2192 PR creation\n6. **Configuration** \u2014 `.vendored/config.json` structure with field descriptions (repo, protected, allowed, install_branch, private, automerge, dogfood)\n7. **Vendor contract** \u2014 what a vendor repo must provide (install.sh at root, version via GitHub Releases or VERSION file, self-registration in config)\n8. **Protection rules** \u2014 how vendored/check enforces protected file patterns\n\nKeep it simple and practical \u2014 favor examples over prose. No need to document internal implementation details.\n\n## Acceptance Criteria\n\n- [ ] `README.md` exists at the repo root\n- [ ] Covers all sections listed above\n- [ ] Reflects the post-refactoring state (add/update commands, not the old install command)\n- [ ] Includes concrete usage examples (commands, config snippets)\n- [ ] Simple and concise \u2014 no unnecessary verbosity","deps":[{"id":"gv-d942.5","type":"follows"}],"started_at":"2026-02-10T05:10:08Z","commit":"b8119bb","implementer":"claude-opus-4-6","cost":{"input":15000,"output":4000},"implemented_at":"2026-02-10T05:10:52Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:21:21Z","scores":{"correctness":95,"completeness":92,"quality":90,"testing":80,"documentation":95},"score":90.4},"closed_at":"2026-02-10T05:22:09Z"}
{"id":"gv-2253","title":"1shots","status":"open","issue_type":"epic","priority":2,"created_at":"2026-02-10T05:30:48Z","body":"Small, single-session work items."}
{"id":"gv-2253.1","title":"Add pre-commit hook for vendor file protection","status":"implemented","issue_type":"task","priority":2,"created_at":"2026-02-10T05:31:06Z","parent":"gv-2253","body":"Add a pre-commit hook that enforces the same vendor file protection as the check-vendor GHA workflow, vendored to consumer repos via install.sh.\n\n## Design\n\n- Add `--staged` flag to `vendored/check` \u2014 checks `git diff --cached --name-only` (staged files) instead of branch diff\n- Create `vendored/hooks/pre-commit` \u2014 thin shell script calling `python3 .vendored/check --staged`\n- Add `--install-hook` flag to `vendored/check` \u2014 symlinks `.vendored/hooks/pre-commit` into `.git/hooks/pre-commit`, force-overwriting any existing hook (including pearls)\n- Update `install.sh` to download the hook to `.vendored/hooks/pre-commit`\n\n## Acceptance criteria\n\n### `--staged` mode\n- [ ] `vendored/check --staged` checks staged files via `git diff --cached --name-only`\n- [ ] Reuses all existing protection logic (patterns, allowed lists, install-branch skip)\n- [ ] Exits 0 if no staged violations, 1 if violations found\n- [ ] Works both in CI and locally (no dependency on GitHub env vars)\n\n### `vendored/hooks/pre-commit`\n- [ ] Shell script at `vendored/hooks/pre-commit` that runs `python3 .vendored/check --staged`\n- [ ] Exits with the check script exit code\n- [ ] Executable permissions set\n\n### `--install-hook` mode\n- [ ] `vendored/check --install-hook` symlinks `.git/hooks/pre-commit` to `.vendored/hooks/pre-commit` (relative: `../../.vendored/hooks/pre-commit`)\n- [ ] Force-overwrites any existing pre-commit hook (file or symlink) \u2014 squashes pearls etc.\n- [ ] Verifies `.vendored/hooks/pre-commit` exists before symlinking, errors if missing\n- [ ] Prints confirmation message on success\n\n### install.sh\n- [ ] Downloads `vendored/hooks/pre-commit` to `.vendored/hooks/pre-commit`\n- [ ] Sets executable permissions (`chmod +x`)\n- [ ] Creates `.vendored/hooks/` directory\n\n### Tests\n- [ ] Unit tests for `--staged` mode in `tests/test_check.py` (staged files checked, protection logic applied, violations reported)\n- [ ] Unit test for `--install-hook` (symlink created, overwrites existing, errors on missing hook file)\n\n### Docs\n- [ ] Update `install.sh` header comment to document the new hook file\n- [ ] Add `--staged` and `--install-hook` to the check script docstring","references":[{"file":"vendored/check"},{"file":"install.sh"},{"file":"vendored/hooks/pre-commit"}],"estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":40000,"output":15000}}],"started_at":"2026-02-10T05:31:36Z","commit":"22a3a3e","implementer":"claude-opus-4-6","cost":{"input":55000,"output":12000},"implemented_at":"2026-02-10T05:35:17Z"}
{"id":"gv-d942.7","title":"Workflow template changes not propagated to existing consumer repos on upgrade","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-10T05:21:42Z","parent":"gv-d942","references":[{"file":"install.sh","lines":["82-88"]},{"commit":"140a2f3"}],"deps":[{"id":"gv-d942.5","type":"caused_by"}],"started_at":"2026-02-10T05:29:21Z","commit":"5cd5236","implementer":"claude-opus-4-6","cost":{"input":50000,"output":8000},"implemented_at":"2026-02-10T05:30:54Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:32:36Z","scores":{"correctness":95,"completeness":95,"quality":90,"testing":90,"documentation":85},"score":91.0},"closed_at":"2026-02-10T05:32:52Z"}
{"id":"gv-d942.8","title":"No tests for workflow token/automerge changes","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-10T05:21:46Z","parent":"gv-d942","deps":[{"id":"gv-d942.3","type":"caused_by"}],"references":[{"commit":"fca823f"}],"started_at":"2026-02-10T05:31:06Z","commit":"8e02872","implementer":"claude-opus-4-6","cost":{"input":30000,"output":5000},"implemented_at":"2026-02-10T05:32:24Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-10T05:32:44Z","scores":{"correctness":95,"completeness":92,"quality":90,"testing":95,"documentation":82},"score":90.8},"closed_at":"2026-02-10T05:32:52Z"}
{"id":"gv-cf3f","title":"Vendor contract v2: manifest-driven install/check/remove","status":"open","issue_type":"epic","priority":1,"created_at":"2026-02-11T02:11:29Z","body":"Redesign the vendor contract around a manifest-based approach. Flatten repo structure, merge add+update into install, add remove command, and shift version/metadata ownership to the framework.","estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":165000,"output":59000}}],"deps":[{"id":"gv-a34c","type":"blocks"}]}
{"id":"gv-cf3f.1","title":"Flatten repo structure into templates/","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T04:13:12Z","parent":"gv-cf3f","body":"Move all installable files under a single `templates/` directory. Currently source files are split between `vendored/` (scripts) and `templates/` (config + workflows) for no clear reason.\n\n## Acceptance Criteria\n\n### File moves\n- [ ] `vendored/add` \u2192 `templates/add`\n- [ ] `vendored/update` \u2192 `templates/update`\n- [ ] `vendored/check` \u2192 `templates/check`\n- [ ] `vendored/hooks/pre-commit` \u2192 `templates/hooks/pre-commit`\n- [ ] `templates/vendored/config.json` \u2192 `templates/config.json`\n- [ ] `vendored/` directory deleted (empty after moves)\n- [ ] `templates/vendored/` directory deleted (empty after moves)\n\n### install.sh updates\n- [ ] `fetch_file` calls reference `templates/add`, `templates/update`, `templates/check`, `templates/hooks/pre-commit` instead of `vendored/...`\n- [ ] Config template fetched from `templates/config.json` instead of `templates/vendored/config.json`\n- [ ] install.sh still passes all existing test_installer.py tests (after path updates in tests)\n\n### Housekeeping\n- [ ] `.semver/config.json` `files` array: remove `vendored/*` (now redundant since `templates/*` already covers it)\n- [ ] All test imports updated: `ROOT / \"vendored\" / \"add\"` \u2192 `ROOT / \"templates\" / \"add\"`, etc.\n- [ ] All existing tests pass with the new paths\n\n### Out of scope\n- Renaming scripts (add\u2192install, etc.) \u2014 that's gv-cf3f.2\n- Manifest storage \u2014 that's gv-cf3f.3","deps":[{"id":"gv-cf3f.2","type":"blocks"}],"estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":20000,"output":6000}}],"started_at":"2026-02-11T05:03:30Z","commit":"2557a63","implementer":"claude-opus-4-6","cost":{"input":60000,"output":8000},"implemented_at":"2026-02-11T05:05:32Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T05:41:48Z","scores":{"correctness":95,"completeness":95,"quality":92,"testing":88,"documentation":82},"score":90.4},"closed_at":"2026-02-11T05:41:56Z"}
{"id":"gv-cf3f.2","title":"Merge add+update into unified install command","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T04:13:37Z","parent":"gv-cf3f","body":"Create a single `templates/install` script that replaces both `templates/add` and `templates/update`. The command is idempotent: it detects whether the vendor exists and handles both first-time add and update flows.\n\n## Acceptance Criteria\n\n### Unified command\n- [ ] `templates/install` exists, executable, handles both add and update\n- [ ] Usage: `.vendored/install <owner/repo> [--version <version>] [--force] [--pr] [--name <name>]`\n- [ ] If vendor not registered: pre-validate (repo exists, has install.sh, version resolvable), run install.sh, post-validate (self-registered with required fields)\n- [ ] If vendor already registered: resolve version, skip if already at target (unless `--force`), download and run install.sh\n- [ ] `--pr` flag creates a PR with changes (same behavior as current `update --pr`)\n- [ ] `--name` flag overrides vendor key name (same behavior as current `add --name`)\n- [ ] Structured output preserved: vendor, old_version, new_version, changed (key=value lines, GITHUB_OUTPUT)\n\n### Removed files\n- [ ] `templates/add` deleted\n- [ ] `templates/update` deleted\n\n### Workflow update\n- [ ] `templates/github/workflows/install-vendored.yml` calls `.vendored/install` instead of `.vendored/update`\n- [ ] Workflow input semantics unchanged (vendor name, version)\n\n### install.sh bootstrap update\n- [ ] `install.sh` fetches `templates/install` \u2192 `.vendored/install` (instead of separate add + update)\n- [ ] `install.sh` no longer fetches or installs `.vendored/add` or `.vendored/update`\n- [ ] `install.sh` cleans up old `.vendored/add` and `.vendored/update` on upgrade\n\n### Tests\n- [ ] `tests/test_install.py` created, covering both add-path and update-path flows\n- [ ] Tests cover: version skip logic, --force override, pre-validation (add path), structured output, PR creation, multi-vendor \"all\" mode\n- [ ] `tests/test_add.py` and `tests/test_update.py` deleted\n- [ ] `tests/test_installer.py` updated for new paths (.vendored/install instead of .vendored/add + .vendored/update)\n- [ ] All tests pass","deps":[{"id":"gv-cf3f.1","type":"blocked_by"},{"id":"gv-cf3f.3","type":"blocks"}],"estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":40000,"output":15000}}],"started_at":"2026-02-11T05:05:40Z","commit":"e811787","implementer":"claude-opus-4-6","cost":{"input":80000,"output":12000},"implemented_at":"2026-02-11T05:10:32Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T05:42:14Z","scores":{"correctness":92,"completeness":92,"quality":88,"testing":88,"documentation":82},"score":88.4},"closed_at":"2026-02-11T05:42:21Z"}
{"id":"gv-cf3f.3","title":"Add manifest emission to the vendor install contract","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T04:14:05Z","parent":"gv-cf3f","body":"Shift from \"vendor self-registers in config\" to \"vendor emits a file manifest, framework handles the rest.\" The framework sets env vars before running install.sh, reads the manifest after, and stores it alongside a version file.\n\n## Acceptance Criteria\n\n### Environment variables passed to install.sh\n- [ ] Framework sets `VENDOR_REPO` (owner/repo) before running install.sh\n- [ ] Framework sets `VENDOR_REF` (git ref, e.g. `v1.2.0`) before running install.sh\n- [ ] Framework sets `VENDOR_MANIFEST` (path to temp file for manifest output) before running install.sh\n- [ ] Framework passes `GH_TOKEN` for authenticated API access\n- [ ] Version is no longer passed as a positional arg to install.sh (`bash install.sh <version>` \u2192 just `bash install.sh`)\n\n### Post-install manifest handling\n- [ ] Framework reads `$VENDOR_MANIFEST` after install.sh completes\n- [ ] Validation: manifest is non-empty (at least one file listed)\n- [ ] Validation: every file listed in manifest exists on disk\n- [ ] Validation failure exits non-zero with a clear error message\n- [ ] Manifest stored at `.vendored/manifests/<vendor>.files` (one path per line, no trailing newline noise)\n- [ ] Version stored at `.vendored/manifests/<vendor>.version` (single line)\n- [ ] `.vendored/manifests/` directory created automatically if missing\n\n### Config.json update\n- [ ] `protected` field derived from manifest contents (all files in manifest + the manifest file itself + the version file)\n- [ ] Existing user-specified `allowed` entries preserved\n- [ ] `install_branch` and `repo` fields still set/updated as before\n\n### Backwards compatibility (v1 vendors)\n- [ ] If install.sh does not write to `$VENDOR_MANIFEST` (v1 vendor), framework falls back to detecting config changes (current behavior)\n- [ ] If install.sh self-registers in config (v1 behavior), framework extracts the info and does not error\n- [ ] On next install of a v1 vendor that starts emitting manifests, the transition is seamless\n\n### Tests\n- [ ] Tests for env var setup: VENDOR_REPO, VENDOR_REF, VENDOR_MANIFEST passed correctly\n- [ ] Tests for manifest validation: empty manifest, missing files, valid manifest\n- [ ] Tests for manifest storage: correct paths, correct content\n- [ ] Tests for v1 fallback: vendor that doesn't write manifest still works\n- [ ] Tests for `protected` derivation from manifest\n- [ ] All existing tests still pass","deps":[{"id":"gv-cf3f.2","type":"blocked_by"},{"id":"gv-cf3f.4","type":"blocks"},{"id":"gv-cf3f.5","type":"blocks"},{"id":"gv-cf3f.6","type":"blocks"}],"estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":35000,"output":12000}}],"started_at":"2026-02-11T05:10:39Z","commit":"050f57e","implementer":"claude-opus-4-6","cost":{"input":50000,"output":10000},"implemented_at":"2026-02-11T05:13:54Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T05:42:44Z","scores":{"correctness":85,"completeness":80,"quality":85,"testing":82,"documentation":80},"score":82.4},"closed_at":"2026-02-11T05:42:51Z"}
{"id":"gv-cf3f.4","title":"Derive protection rules from manifests in check","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T04:14:28Z","parent":"gv-cf3f","body":"Update the check command to read protection rules from `.vendored/manifests/<vendor>.files` instead of the `protected` field in config.json. This completes the shift to manifest-driven protection.\n\n## Acceptance Criteria\n\n### Manifest-based protection\n- [ ] `check` reads `.vendored/manifests/<vendor>.files` for each registered vendor\n- [ ] Protected set = files listed in manifest + `.vendored/manifests/<vendor>.files` + `.vendored/manifests/<vendor>.version`\n- [ ] Changed files matched against the manifest-derived protected set (exact path match, not glob)\n- [ ] `allowed` exceptions from config.json still apply\n\n### Backwards compatibility\n- [ ] If `.vendored/manifests/<vendor>.files` does not exist, fall back to `protected` globs from config.json (v1 behavior)\n- [ ] Fallback uses existing glob matching logic (fnmatch with ** support)\n- [ ] Mixed state works: some vendors have manifests, others use config `protected`\n\n### Config migration\n- [ ] When `install` runs and creates a manifest, the `protected` field is removed from that vendor's config entry\n- [ ] This is additive to gv-cf3f.3 \u2014 the install command should stop writing `protected` to config once manifests are in use\n\n### Branch bypass\n- [ ] Install branch bypass logic unchanged: if branch matches `install_branch` prefix, skip that vendor's checks\n\n### Tests\n- [ ] Tests for manifest-based protection: exact path matching from manifest files\n- [ ] Tests for fallback to config `protected` when no manifest exists\n- [ ] Tests for mixed state: one vendor with manifest, another without\n- [ ] Tests for manifest files themselves being protected (the .files and .version files)\n- [ ] Tests for `allowed` exceptions still working with manifest-based protection\n- [ ] All existing check tests still pass (with any necessary fixture updates)","deps":[{"id":"gv-cf3f.3","type":"blocked_by"}],"estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":25000,"output":8000}}],"started_at":"2026-02-11T05:14:02Z","commit":"6d68ad1","implementer":"claude-opus-4-6","cost":{"input":30000,"output":5000},"implemented_at":"2026-02-11T05:15:16Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T05:43:13Z","scores":{"correctness":90,"completeness":82,"quality":82,"testing":90,"documentation":80},"score":84.8},"closed_at":"2026-02-11T05:43:20Z"}
{"id":"gv-cf3f.5","title":"Create remove command for clean vendor uninstall","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T04:14:50Z","parent":"gv-cf3f","body":"Add a new `templates/remove` command that uses the manifest to cleanly uninstall a vendor \u2014 deleting all its files, its manifest, and its config entry.\n\n## Acceptance Criteria\n\n### Command interface\n- [ ] `templates/remove` exists, executable Python 3 script\n- [ ] Usage: `.vendored/remove <vendor>`\n- [ ] Exits non-zero with clear error if vendor not found in config.json\n- [ ] Exits non-zero with clear error if no manifest exists for the vendor (and no `protected` fallback for delete \u2014 too risky without a manifest)\n\n### Removal flow\n- [ ] Reads `.vendored/manifests/<vendor>.files` to get list of files to delete\n- [ ] Deletes every file listed in the manifest\n- [ ] Deletes `.vendored/manifests/<vendor>.files`\n- [ ] Deletes `.vendored/manifests/<vendor>.version`\n- [ ] Removes the vendor entry from `.vendored/config.json`\n- [ ] Cleans up empty parent directories left behind (e.g., if all files in `.some-tool/` are deleted, remove `.some-tool/`)\n\n### Output\n- [ ] Reports each file deleted\n- [ ] Reports summary: \"Removed vendor: <name> (N files deleted)\"\n- [ ] Handles already-missing files gracefully (warn, don't error \u2014 file may have been manually deleted)\n\n### Bootstrap\n- [ ] `install.sh` fetches `templates/remove` \u2192 `.vendored/remove` and makes it executable\n- [ ] `.vendored/remove` included in git-vendored's own self-registered protected files\n\n### Tests\n- [ ] Test: successful removal deletes all manifest files, manifest itself, and config entry\n- [ ] Test: error when vendor not in config\n- [ ] Test: error when no manifest file exists\n- [ ] Test: graceful handling of already-missing files in manifest\n- [ ] Test: empty directory cleanup after file deletion\n- [ ] Test: config.json still valid JSON after removal (other vendors unaffected)\n- [ ] All existing tests still pass","deps":[{"id":"gv-cf3f.3","type":"blocked_by"},{"id":"gv-cf3f.6","type":"blocks"},{"id":"gv-cf3f.7","type":"causes"}],"estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":20000,"output":8000}}],"started_at":"2026-02-11T05:15:23Z","commit":"f4d8189","implementer":"claude-opus-4-6","cost":{"input":30000,"output":8000},"implemented_at":"2026-02-11T05:17:30Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T06:04:47Z","scores":{"correctness":90,"completeness":90,"quality":88,"testing":88,"documentation":82},"score":87.6},"closed_at":"2026-02-11T06:04:54Z"}
{"id":"gv-cf3f.6","title":"Rewrite bootstrap install.sh for v2 manifest contract","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T04:15:17Z","parent":"gv-cf3f","body":"Rewrite git-vendored's own `install.sh` (the bootstrap) to conform to the v2 vendor contract: read env vars instead of positional args, emit a manifest instead of self-registering in config, and source files from the flattened `templates/` layout.\n\n## Acceptance Criteria\n\n### v2 contract compliance\n- [ ] install.sh reads `VENDOR_REF` instead of `$1` for version (fall back to `$1` for backwards compat during transition)\n- [ ] install.sh reads `VENDOR_REPO` instead of `$2` for repo (fall back to `$2` / hardcoded default)\n- [ ] install.sh writes a manifest to `$VENDOR_MANIFEST` listing every file it creates/modifies\n- [ ] install.sh does NOT self-register in `.vendored/config.json` (framework does this now)\n- [ ] install.sh does NOT write `.vendored/.version` (framework writes `.vendored/manifests/git-vendored.version`)\n\n### Manifest contents\nThe manifest must list every file installed:\n- [ ] `.vendored/install`\n- [ ] `.vendored/check`\n- [ ] `.vendored/remove`\n- [ ] `.vendored/hooks/pre-commit`\n- [ ] `.github/workflows/install-vendored.yml`\n- [ ] `.github/workflows/check-vendor.yml`\n\n### Directory setup\n- [ ] Creates `.vendored/`, `.vendored/hooks/`, `.vendored/manifests/`, `.github/workflows/` directories\n- [ ] `.vendored/config.json` only created if missing (preserve existing \u2014 same as current behavior)\n\n### Source paths\n- [ ] All `fetch_file` calls reference `templates/` paths (already done in gv-cf3f.1, verify still correct)\n\n### Cleanup\n- [ ] Removes deprecated `.vendored/add`, `.vendored/update` (migrating from v1)\n- [ ] Removes deprecated `.vendored/.version` (replaced by manifests/<vendor>.version)\n\n### Tests\n- [ ] test_installer.py updated for v2 contract: env var inputs, manifest output, no config self-registration\n- [ ] Test: manifest file written to $VENDOR_MANIFEST path with correct contents\n- [ ] Test: config.json not modified by install.sh (framework's job)\n- [ ] Test: backwards compat \u2014 positional args still work when env vars not set\n- [ ] Test: deprecated files cleaned up on upgrade\n- [ ] All tests pass\n\n### README\n- [ ] Update README \"Vendor Contract\" section to document the v2 env var contract\n- [ ] Update README \"Quick Start\" section if bootstrap invocation changes\n- [ ] Update config schema docs: `protected` no longer in config, derived from manifests\n- [ ] Add migration note for v1 \u2192 v2","deps":[{"id":"gv-cf3f.3","type":"blocked_by"},{"id":"gv-cf3f.5","type":"blocked_by"},{"id":"gv-cf3f.8","type":"causes"},{"id":"gv-cf3f.9","type":"causes"},{"id":"gv-cf3f.10","type":"causes"},{"id":"gv-cf3f.11","type":"causes"}],"estimates":[{"estimator":"claude-opus-4-6","implementer":"claude-opus-4-6","cost":{"input":25000,"output":10000}}],"started_at":"2026-02-11T05:17:38Z","commit":"49cfcc1","implemented_at":"2026-02-11T05:20:44Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T06:05:10Z","scores":{"correctness":88,"completeness":88,"quality":85,"testing":85,"documentation":88},"score":86.8},"closed_at":"2026-02-11T06:05:17Z"}
{"id":"gv-cf3f.7","title":"Remove command should error without manifest instead of falling back to pattern scan","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-11T05:43:50Z","parent":"gv-cf3f","references":[{"file":"templates/remove","lines":["82-109"]},{"commit":"f4d8189"}],"deps":[{"id":"gv-cf3f.5","type":"caused_by"}],"started_at":"2026-02-11T05:51:27Z","commit":"6a39ddd","implementer":"claude-opus-4-6","cost":{"input":50000,"output":8000},"implemented_at":"2026-02-11T05:53:19Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T06:05:32Z","scores":{"correctness":95,"completeness":95,"quality":92,"testing":92,"documentation":85},"score":91.8},"closed_at":"2026-02-11T06:05:38Z"}
{"id":"gv-cf3f.8","title":"install.sh doesn't read VENDOR_REF/VENDOR_REPO env vars per v2 contract","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-11T05:44:19Z","parent":"gv-cf3f","references":[{"file":"install.sh","lines":["23-24"]},{"commit":"49cfcc1"}],"deps":[{"id":"gv-cf3f.6","type":"caused_by"}],"started_at":"2026-02-11T05:53:30Z","commit":"cf35082","implementer":"claude-opus-4-6","cost":{"input":25000,"output":5000},"implemented_at":"2026-02-11T05:54:30Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T06:05:47Z","scores":{"correctness":95,"completeness":95,"quality":92,"testing":90,"documentation":88},"score":92.0},"closed_at":"2026-02-11T06:05:53Z"}
{"id":"gv-cf3f.9","title":"install.sh still self-registers in config.json (v2 contract says framework handles this)","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-11T05:44:23Z","parent":"gv-cf3f","references":[{"file":"install.sh","lines":["95-114"]},{"commit":"49cfcc1"}],"deps":[{"id":"gv-cf3f.6","type":"caused_by"}],"started_at":"2026-02-11T05:54:41Z","commit":"1817294","implementer":"claude-opus-4-6","cost":{"input":20000,"output":5000},"implemented_at":"2026-02-11T05:55:38Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T06:06:10Z","scores":{"correctness":95,"completeness":92,"quality":90,"testing":90,"documentation":85},"score":90.4},"closed_at":"2026-02-11T06:06:16Z"}
{"id":"gv-cf3f.10","title":"install.sh still writes deprecated .vendored/.version (should use manifests only)","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-11T05:44:27Z","parent":"gv-cf3f","references":[{"file":"install.sh","lines":["73-75"]},{"commit":"49cfcc1"}],"deps":[{"id":"gv-cf3f.6","type":"caused_by"}],"started_at":"2026-02-11T05:55:49Z","commit":"3527e13","implementer":"claude-opus-4-6","cost":{"input":25000,"output":6000},"implemented_at":"2026-02-11T05:57:05Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T06:06:25Z","scores":{"correctness":95,"completeness":95,"quality":90,"testing":92,"documentation":82},"score":90.8},"closed_at":"2026-02-11T06:06:33Z"}
{"id":"gv-cf3f.11","title":"README not updated for v2 manifest contract (vendor contract, quick start, config schema, migration note)","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-11T05:44:31Z","parent":"gv-cf3f","references":[{"file":"README.md"},{"commit":"49cfcc1"}],"deps":[{"id":"gv-cf3f.6","type":"caused_by"}],"started_at":"2026-02-11T05:57:16Z","commit":"22ab367","implementer":"claude-opus-4-6","cost":{"input":20000,"output":8000},"implemented_at":"2026-02-11T05:58:29Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T06:06:49Z","scores":{"correctness":92,"completeness":92,"quality":90,"testing":85,"documentation":95},"score":90.8},"closed_at":"2026-02-11T06:06:55Z"}
{"id":"gv-a34c","title":"Directory Restructure: Consolidate Vendor Files Under .vendored/","status":"open","issue_type":"epic","priority":1,"created_at":"2026-02-11T16:53:38Z","body":"Consolidate per-vendor dotdirs (`.pearls/`, `.dogfood/`, `.semver/`) and the shared `config.json` into a structured layout under `.vendored/`:\n\n- **`configs/<vendor>.json`** \u2014 per-vendor config (replaces monolithic `config.json`)\n- **`pkg/<vendor>/`** \u2014 vendor-installed files (replaces per-vendor dotdirs at repo root)\n\nThis eliminates dotdir sprawl and merge conflicts from concurrent vendor update PRs.\n\n**Depends on:** gv-cf3f (v2 contract \u2014 manifests, env vars) \u2014 all tasks closed.","deps":[{"id":"gv-cf3f","type":"blocked_by"}]}
{"id":"gv-a34c.1","title":"Refactor config loading to support per-vendor config files","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T16:53:56Z","parent":"gv-a34c","body":"## Summary\n\nRefactor `load_config()` and `save_config()` across all three framework commands (install, check, remove) to support per-vendor config files under `.vendored/configs/`.\n\n## Acceptance Criteria\n\n- [ ] `load_config()` scans `.vendored/configs/` for `<vendor>.json` files\n- [ ] Vendor name is derived from filename (e.g., `pearls.json` \u2192 `pearls`)\n- [ ] Each `<vendor>.json` contains vendor settings directly (no wrapping `vendors` key)\n- [ ] `save_config()` in templates/install writes individual `configs/<vendor>.json`\n- [ ] `save_config()` in templates/remove deletes `configs/<vendor>.json` when removing a vendor\n- [ ] Backwards compat: falls back to monolithic `config.json` if `configs/` dir doesn't exist or has no `.json` files\n- [ ] `protected` field preserved in per-vendor config for v1 fallback compatibility\n- [ ] Tests updated in test_install.py, test_check.py, test_remove.py\n\n## Key Files\n\n- `templates/install` \u2014 `load_config()` at L39, `save_config()` at L48\n- `templates/check` \u2014 `load_config()` at L31\n- `templates/remove` \u2014 `load_config()` at L26, `save_config()` at L35\n\n## Per-vendor Config Schema\n\n```json\n{\n  \"repo\": \"owner/repo\",\n  \"install_branch\": \"chore/install-<name>\",\n  \"private\": false,\n  \"dogfood\": false,\n  \"automerge\": false,\n  \"protected\": [\"...\"],\n  \"allowed\": [\"...\"]\n}\n```\n\n## Notes\n\n- `config.json` remains on disk (for framework-level settings and migration detection)\n- The `vendors` key in `config.json` is only used during backwards-compat fallback\n- Return format from `load_config()` stays the same: `{\"vendors\": {\"name\": {...}, ...}}`","references":[{"file":"templates/install","lines":["39-45"]}],"deps":[{"id":"gv-a34c.5","type":"blocks"},{"id":"gv-a34c.6","type":"blocks"},{"id":"gv-a34c.7","type":"causes"}],"started_at":"2026-02-11T17:16:56Z","commit":"09518a6","implementer":"claude-opus-4-6","cost":{"input":85000,"output":12000},"implemented_at":"2026-02-11T17:18:55Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T18:41:31Z","scores":{"correctness":78,"completeness":88,"quality":80,"testing":82,"documentation":85},"score":82.6},"closed_at":"2026-02-11T18:49:59Z"}
{"id":"gv-a34c.2","title":"Pass VENDOR_INSTALL_DIR env var to vendor install.sh","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T16:54:07Z","parent":"gv-a34c","body":"## Summary\n\nPass `VENDOR_INSTALL_DIR` environment variable to vendor `install.sh` scripts so vendors can install files under `.vendored/pkg/<vendor>/`.\n\n## Acceptance Criteria\n\n- [ ] `download_and_run_install()` sets `VENDOR_INSTALL_DIR=.vendored/pkg/<vendor>` in run_env\n- [ ] Framework creates `.vendored/pkg/<vendor>/` directory before running install.sh\n- [ ] Dogfood exception: does NOT set `VENDOR_INSTALL_DIR` when vendor has `\"dogfood\": true`\n- [ ] `templates/remove` deletes `.vendored/pkg/<vendor>/` directory when removing a vendor\n- [ ] `cleanup_empty_dirs()` handles `pkg/` parent directory cleanup\n- [ ] Tests: env var set correctly, directory created, dogfood exception, removal cleans up\n\n## Key Files\n\n- `templates/install` \u2014 `download_and_run_install()` at L241, env vars at L280-285\n- `templates/remove` \u2014 `get_files_to_remove()` at L51, `cleanup_empty_dirs()` at L83\n\n## Contract\n\nVendors SHOULD install files under `$VENDOR_INSTALL_DIR` but MAY install to other paths (workflows, hooks) when the target system requires specific locations. All installed files must appear in the manifest regardless of location.\n\nIf `$VENDOR_INSTALL_DIR` is not set, vendor falls back to its original layout (backwards compat).\n\n## Notes\n\n- Manifest-based protection in `check` automatically covers pkg/ paths \u2014 no check changes needed\n- Stale file cleanup on migration (old dotdir \u2192 pkg/) is out of scope \u2014 consumers use `remove` + `install` to migrate","references":[{"file":"templates/install","lines":["241-309"]}],"deps":[{"id":"gv-a34c.6","type":"blocks"}],"started_at":"2026-02-11T17:19:06Z","commit":"8734b5e","implementer":"claude-opus-4-6","cost":{"input":30000,"output":6000},"implemented_at":"2026-02-11T17:21:52Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T18:41:34Z","scores":{"correctness":90,"completeness":90,"quality":88,"testing":90,"documentation":85},"score":88.6},"closed_at":"2026-02-11T18:42:21Z"}
{"id":"gv-a34c.3","title":"Write vendor compliance guide for directory restructure","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-11T16:54:14Z","parent":"gv-a34c","body":"## Summary\n\nWrite a markdown implementation guide that lives in the repo and instructs vendor repos (and AI tools working on them) on how to comply with the new directory structure.\n\n## Acceptance Criteria\n\n- [ ] Markdown file at `docs/vendor-install-dir-guide.md`\n- [ ] Documents `VENDOR_INSTALL_DIR` contract: env var, when it's set, expected behavior\n- [ ] Documents per-vendor config schema (fields, types, defaults)\n- [ ] Shows before/after examples of vendor file layouts\n- [ ] Provides code examples: how a vendor's `install.sh` reads and uses `$VENDOR_INSTALL_DIR`\n- [ ] Documents fallback behavior when `$VENDOR_INSTALL_DIR` is not set\n- [ ] Lists what vendor repos need to change\n- [ ] Documents migration path for consumer repos (remove + re-install)\n\n## Audience\n\nAI agents and developers working on vendor repos (pearls, git-dogfood, git-semver) who need to update their `install.sh` scripts for compatibility with the new directory structure.\n\n## Notes\n\n- Vendor repo changes are out of scope for this epic \u2014 only the guide is in scope\n- The guide should be actionable: someone reading it should know exactly what to change","deps":[{"id":"gv-a34c.4","type":"blocks"}],"started_at":"2026-02-11T17:22:03Z","commit":"caf1e88","implementer":"claude-opus-4-6","cost":{"input":12000,"output":4000},"implemented_at":"2026-02-11T17:23:02Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T18:41:38Z","scores":{"correctness":90,"completeness":90,"quality":90,"testing":85,"documentation":92},"score":89.4},"closed_at":"2026-02-11T18:42:25Z"}
{"id":"gv-a34c.4","title":"Update README and docs for new directory layout","status":"closed","issue_type":"task","priority":3,"created_at":"2026-02-11T16:54:18Z","parent":"gv-a34c","body":"## Summary\n\nUpdate the README and existing documentation to reflect the new `.vendored/` directory layout after all implementation tasks are complete.\n\n## Acceptance Criteria\n\n- [ ] README documents new `.vendored/` layout (configs/, pkg/, manifests/)\n- [ ] README documents `VENDOR_INSTALL_DIR` env var in contract/env vars section\n- [ ] README documents per-vendor config format and schema\n- [ ] Migration notes section for existing consumer repos\n- [ ] Remove references to per-vendor dotdirs at repo root as the primary layout\n\n## Key Files\n\n- `README.md`\n- Any other docs referencing the old layout","deps":[{"id":"gv-a34c.6","type":"blocked_by"},{"id":"gv-a34c.3","type":"blocked_by"}],"started_at":"2026-02-11T17:25:52Z","commit":"2d3b6cd","implementer":"claude-opus-4-6","cost":{"input":15000,"output":4000},"implemented_at":"2026-02-11T17:27:26Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T18:41:41Z","scores":{"correctness":88,"completeness":85,"quality":88,"testing":85,"documentation":90},"score":87.2},"closed_at":"2026-02-11T18:42:29Z"}
{"id":"gv-a34c.5","title":"Add config migration from monolithic config.json to per-vendor configs/","status":"closed","issue_type":"task","priority":1,"created_at":"2026-02-11T16:54:36Z","parent":"gv-a34c","body":"## Summary\n\nAdd a migration function that splits monolithic `config.json` vendors into individual `configs/<vendor>.json` files. Triggered automatically during install when monolithic config is detected.\n\n## Acceptance Criteria\n\n- [ ] `migrate_config()` function reads `config.json` `vendors` dict, writes each vendor to `configs/<vendor>.json`\n- [ ] Creates `.vendored/configs/` directory if it doesn't exist\n- [ ] Removes `vendors` key from `config.json` after successful migration (file remains for framework-level use)\n- [ ] Called from `templates/install` main() when: monolithic config has `vendors` AND `configs/` dir has no `.json` files\n- [ ] Idempotent: running migration twice doesn't duplicate or corrupt data\n- [ ] Logs migration action to stderr for visibility\n- [ ] Tests: creates correct files, cleans up config.json, idempotency\n\n## Key Files\n\n- `templates/install` \u2014 add `migrate_config()`, call from `main()` before `load_config()`\n\n## Migration Trigger Logic\n\n```python\n# In main(), before load_config():\nif os.path.exists(CONFIG_PATH):\n    with open(CONFIG_PATH) as f:\n        raw = json.load(f)\n    if \"vendors\" in raw and not any(f.endswith('.json') for f in os.listdir(CONFIGS_DIR)):\n        migrate_config(raw)\n```","deps":[{"id":"gv-a34c.1","type":"blocked_by"},{"id":"gv-a34c.6","type":"blocks"}],"references":[{"file":"templates/install","lines":["48-52"]}],"started_at":"2026-02-11T17:23:17Z","commit":"390fd1e","implementer":"claude-opus-4-6","cost":{"input":18000,"output":5000},"implemented_at":"2026-02-11T17:24:33Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T18:41:45Z","scores":{"correctness":90,"completeness":90,"quality":88,"testing":92,"documentation":82},"score":88.4},"closed_at":"2026-02-11T18:42:32Z"}
{"id":"gv-a34c.6","title":"Update bootstrap install.sh for new directory structure","status":"closed","issue_type":"task","priority":2,"created_at":"2026-02-11T16:54:43Z","parent":"gv-a34c","body":"## Summary\n\nUpdate the bootstrap `install.sh` to create the new `configs/` and `pkg/` directories during framework installation.\n\n## Acceptance Criteria\n\n- [ ] `install.sh` creates `.vendored/configs/` directory during bootstrap\n- [ ] `install.sh` creates `.vendored/pkg/` directory during bootstrap\n- [ ] Existing `mkdir -p` line updated to include new directories\n- [ ] Config migration is NOT done in install.sh \u2014 it runs when `templates/install` is invoked (keeps bash simple, migration logic in Python)\n- [ ] Tests in test_installer.py verify new directory creation\n\n## Key Files\n\n- `install.sh` \u2014 directory creation at L49\n\n## Notes\n\n- `install.sh` is a bash script that must stay simple \u2014 it just creates dirs and downloads files\n- The actual config migration runs when `templates/install` is first invoked after the framework update\n- This is blocked by Issues 1 and 2 because the directories only make sense once the commands know how to use them","deps":[{"id":"gv-a34c.1","type":"blocked_by"},{"id":"gv-a34c.2","type":"blocked_by"},{"id":"gv-a34c.5","type":"blocked_by"},{"id":"gv-a34c.4","type":"blocks"}],"references":[{"file":"install.sh","lines":["49"]}],"started_at":"2026-02-11T17:24:44Z","commit":"4bab67a","implementer":"claude-opus-4-6","cost":{"input":10000,"output":2000},"implemented_at":"2026-02-11T17:25:43Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T18:41:49Z","scores":{"correctness":92,"completeness":90,"quality":90,"testing":88,"documentation":82},"score":88.4},"closed_at":"2026-02-11T18:42:36Z"}
{"id":"gv-a34c.7","title":"install_new_vendor post-validate broken when per-vendor configs active","status":"closed","issue_type":"bug","priority":2,"created_at":"2026-02-11T18:42:06Z","parent":"gv-a34c","references":[{"file":"templates/install","lines":["427-435"]},{"commit":"09518a6"}],"deps":[{"id":"gv-a34c.1","type":"caused_by"}],"started_at":"2026-02-11T18:48:04Z","commit":"90c0301","implementer":"claude-opus-4-6","cost":{"input":45000,"output":5000},"implemented_at":"2026-02-11T18:49:45Z","evaluation":{"evaluator":"claude-opus-4-6","evaluated_at":"2026-02-11T18:49:53Z","scores":{"correctness":92,"completeness":90,"quality":88,"testing":90,"documentation":85},"score":89.0},"closed_at":"2026-02-11T18:50:06Z"}
